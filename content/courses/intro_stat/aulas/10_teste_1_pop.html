---
title: "Testes para uma população"
author: "Rafael B. Stern"
highlight: true
date: ""
output: html_document
type: book
weight: 100
bibliography: refs.bib
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<script src="/rmarkdown-libs/jquery/jquery-3.6.0.min.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>


<div id="testes-para-uma-população-sigma2-desconhecido" class="section level1">
<h1>Testes para uma população (<span class="math inline">\(\sigma^2\)</span> desconhecido)</h1>
<p>Considere uma amostra independente,
<span class="math inline">\(X_{1}, \ldots, X_{n}\)</span> tal que
<span class="math inline">\(X_{i} \sim N(\mu, \sigma^2)\)</span>,
onde <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma^2\)</span> são desconhecidos.
Note que, ao contrário das aulas anteriores,
consideramos que <span class="math inline">\(\sigma^2\)</span> é desconhecido.
Neste contexto, comumente estamos interessados
em testar as hipóteses:
<span class="math display">\[
\begin{align*}
H_0:
\begin{cases}
  (a) \text{ } \mu \leq \mu_0 &amp; \\
  (b) \text{ } \mu \geq \mu_0 &amp; \\
  (c) \text{ } \mu = \mu_0 &amp;
\end{cases}
\end{align*}
\]</span></p>
<div id="regiões-críticas" class="section level2">
<h2>Regiões críticas</h2>
<p>Similarmente às aulas passadas,
desejamos rejeitar <span class="math inline">\(H_0\)</span> para
os casos (a), (b) e (c) quando, respectivamente,
<span class="math display">\[
\begin{cases}
(a) \text{ } \bar{X}-\mu_0 &gt; k_{a} &amp; \\
(b) \text{ } \bar{X}-\mu_0 &lt; k_{b} &amp; \\
(c) \text{ } |\bar{X}-\mu_{0}| &gt; k_{c}
\end{cases}
\]</span></p>
<p>Nestes testes,
determinamos os valores de
<span class="math inline">\(k_{a}\)</span>, <span class="math inline">\(k_{b}\)</span> e <span class="math inline">\(k_{c}\)</span> utilizando
a condição de que a probabilidade
de erro tipo <span class="math inline">\(I\)</span> é <span class="math inline">\(\alpha\)</span>.
Para usar esta condição,
em aulas anteriores padronizamos
a quantidade <span class="math inline">\(\bar{X}-\mu_0\)</span>
dividindo-a por <span class="math inline">\(\frac{\sigma}{n}\)</span>.
Contudo, agora consideramos que
<span class="math inline">\(\sigma\)</span> é desconhecido e, portanto,
não é possível realizar esta padronização.
Ao contrário, utilizamos a padronização
alternativa de que, quando <span class="math inline">\(\mu = \mu_0\)</span>,
<span class="math inline">\(\frac{\sqrt{n-1}(\bar{X}-\mu_0)}{S} \sim T_{n-1}\)</span>.
Assim, tomando <span class="math inline">\(\mu = \mu_0\)</span>, calculamos a
probabilidade de erro tipo I da seguinte forma
<span class="math display">\[
\begin{align*}
P(\bar{X}-\mu_0 &gt; k_a)
&amp;= P\left(\frac{\sqrt{n-1}(\bar{X}-\mu_0)}{S} &gt; \frac{\sqrt{n-1}k_a}{S}\right) \\
&amp;= P\left(T_{n-1} &gt; \frac{\sqrt{n-1}k_a}{S} \right) \\
&amp;= 1- pt\left(\frac{\sqrt{n-1}k_a}{S}, df = n-1\right)
\end{align*}
\]</span>
Semelhamentemente, obtemos
<span class="math display">\[
\begin{align*}
P(\bar{X}-\mu_0 &lt; k_b)
&amp;= pt\left(\frac{\sqrt{n-1}k_b}{S}, df = n-1\right) \\
P(|\bar{X}-\mu_0| &gt; k_c)
&amp;= 2pt\left(-\frac{\sqrt{n-1}k_c}{S}, df = n-1\right)
\end{align*}
\]</span>
Os valores de <span class="math inline">\(k_a\)</span>, <span class="math inline">\(k_b\)</span> e <span class="math inline">\(k_C\)</span>
são determinados de forma que,
sob a hipótese nula, a
probabilidade de rejeição seja <span class="math inline">\(\alpha\)</span>.
Assim, por exemplo, para <span class="math inline">\(H_0: \mu \leq \mu_0\)</span>,
obtemos a equação
<span class="math display">\[
\begin{align*}
1- pt\left(\frac{\sqrt{n-1}k_a}{S}, df = n-1\right) &amp;= \alpha \\
pt\left(\frac{\sqrt{n-1}k_a}{S}, df = n-1\right) &amp;= 1-\alpha \\
\frac{\sqrt{n-1}k_a}{S} &amp;= qt(1-\alpha, df=n-1) \\
k_a &amp;= \frac{qt(1-\alpha, df=n-1) S}{\sqrt{n-1}}
\end{align*}
\]</span>
Similarmente, obtemos
<span class="math display">\[
\begin{align*}
k_b &amp;= \frac{qt(\alpha, df=n-1) S}{\sqrt{n-1}} \\
k_c &amp;= \frac{qt(1-0.5\alpha, df=n-1) S}{\sqrt{n-1}}
\end{align*}
\]</span>
Portanto, as hipóteses em (a), (b) e (c)
são rejeitadas, respectivamente, quando
<span class="math display">\[
\begin{cases}
\text{(a) } \bar{X}-\mu_0 &gt; \frac{qt(1-\alpha, df=n-1) S}{\sqrt{n-1}} \\
\text{(b) } \bar{X}-\mu_0 &lt; \frac{qt(\alpha, df=n-1) S}{\sqrt{n-1}} \\
\text{(c) } |\bar{X}-\mu_0| &gt; \frac{qt(1-0.5\alpha, df=n-1) S}{\sqrt{n-1}}
\end{cases}
\]</span></p>
</div>
<div id="exemplo" class="section level2">
<h2>Exemplo</h2>
<p>Considere que um pesquisador inexperiente com o paquímetro
mede um objeto <span class="math inline">\(9\)</span> vezes e observa os valores em milímetros:</p>
<pre class="r"><code>dados = c(1.1, 1.3, 1.3, 1.4, 1.6, 1.8, 1.8, 1.9, 2.2)</code></pre>
<p>Considere que o pesquisador deseja testar
a um nível de <span class="math inline">\(\alpha = 0.01\)</span> se
o cumprimento do objeto é 1.5 milímetros, isto é,
<span class="math inline">\(H_0: \mu_0 = 1.5\)</span>. Para tal, ele usará
a região critica identificada em (c),
que pode ser calculada no R da seguinte forma</p>
<pre class="r"><code> mu_0 = 1.5
 alpha = 0.01
 n = length(dados)
 S = sd(dados) * sqrt(n-1)/sqrt(n)
 media = mean(dados)
 lado_esquerdo = abs(media - mu_0)
 lado_esquerdo</code></pre>
<pre><code>## [1] 0.1</code></pre>
<pre class="r"><code> lado_direito = qt(1-0.5*alpha, df=n-1)*S/sqrt(n-1)
 lado_direito</code></pre>
<pre><code>## [1] 0.3954362</code></pre>
<pre class="r"><code> lado_esquerdo &gt; lado_direito</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Note que o cálculo em <em>lado_esquerdo</em> no código
corresponde a <span class="math inline">\(|\bar{X}-\mu_0|\)</span> e o <em>lado_direito</em>
no código corresponde a
<span class="math inline">\(\frac{qt(1-0.5\alpha, df=n-1) S}{\sqrt{n-1}}\)</span>.
Como obtemos que é falso que o lado esquerdo é
maior que o lado direito, não rejeitamos
a hipótese nula.</p>
<p>Este teste também já está implementado no
<strong>R</strong> e podemos obter o resultado que buscamos
digitando diretamente</p>
<pre class="r"><code>t.test(dados, 
       alternative = &quot;two.sided&quot;, 
       mu = 1.5, 
       conf.level = 1-alpha)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  dados
## t = 0.84853, df = 8, p-value = 0.4208
## alternative hypothesis: true mean is not equal to 1.5
## 99 percent confidence interval:
##  1.204564 1.995436
## sample estimates:
## mean of x 
##       1.6</code></pre>
<p>Como o p-valor é <span class="math inline">\(0.42\)</span> e
<span class="math inline">\(\alpha = 0.05\)</span> é menor que o p-valor,
não rejeitamos a hipótese de que
<span class="math inline">\(H_0: \mu = 1.5\)</span>.</p>
</div>
</div>
<div id="exercícios" class="section level1">
<h1>Exercícios</h1>
<ol style="list-style-type: decimal">
<li>Para que um rio tenha água salubre,
a concentração de uma determinada substância deve
ser inferior a 10 mg/L. Uma amostra de água foi
tomada em <span class="math inline">\(9\)</span> pontos distintos do rio,
observando-se concentrações da substância em
mg/L de: 2, 2, 5, 6, 6, 7, 8, 8, 12.
Deseja-se testar se a água do rio e salubre.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Descreve os erros que podem ser cometidos neste teste. Qual o mais grave?</li>
<li>Qual a hipótese nula a ser testada?</li>
<li>Teste a hipótese nula a um nível de significância de <span class="math inline">\(\alpha = 0.05\)</span>.</li>
<li>Calcule o p-valor deste teste.</li>
</ol>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","vertical":false,"data":[[0.025,0.05,0.95,0.975],[-2.31,-1.86,1.86,2.31]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>alpha<\/th>\n      <th>qt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-right","targets":[0,1]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<ol start="2" style="list-style-type: decimal">
<li>Considere que <span class="math inline">\(X_{1},\ldots,X_{n}\)</span> são independentes e
<span class="math inline">\(X_{i} \sim N(\mu,\sigma_0^2)\)</span>, onde <span class="math inline">\(\sigma_0^2\)</span> é conhecido.
Desejamos testar a hipótese <span class="math inline">\(H_0: \mu \leq \mu_0\)</span>.
Note que, a princípio, poderíamos aplicar
tanto o teste com variância populacional conhecida,
quanto o teste com variância populacional desconhecida.
Qual é a vantagem de aplicar o teste com
variância populacional conhecida?
Você pode utilizar a seguinte amostra
onde <span class="math inline">\(\sigma_0^2 = 1\)</span> e <span class="math inline">\(\mu_0 = 0.5\)</span>
para embasar a sua resposta considere que <span class="math inline">\(S = 1\)</span>.
Os seguintes valores podem ser úteis:</li>
</ol>
<div id="htmlwidget-2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"filter":"none","vertical":false,"data":[[0.025,0.05,0.95,0.975],[-1.96,-1.64,1.64,1.96]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>alpha<\/th>\n      <th>qnorm<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-right","targets":[0,1]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div id="htmlwidget-3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"filter":"none","vertical":false,"data":[[0.025,0.05,0.95,0.975],[-2.31,-1.86,1.86,2.31]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>alpha<\/th>\n      <th>qt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-right","targets":[0,1]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
